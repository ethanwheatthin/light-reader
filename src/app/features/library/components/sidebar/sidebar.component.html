
<!-- <div class="sidebar-top">
  <button class="btn-close-mobile" (click)="closeMobile()" aria-label="Close navigation">Ã—</button>
</div> -->

<nav class="sidebar-nav">
  <button class="nav-item active" title="Books">
    <span class="nav-icon">ğŸ“š</span>
    <span class="nav-label">Books</span>
    @if (documents$ | async; as docs) {
      <span class="nav-count">{{ docs.length }}</span>
    }
  </button>
  <button class="nav-item" disabled title="Series">
    <span class="nav-icon">ğŸ“–</span>
    <span class="nav-label">Series</span>
    <span class="nav-count">0</span>
  </button>
  <button class="nav-item" disabled title="Hidden">
    <span class="nav-icon">ğŸ™ˆ</span>
    <span class="nav-label">Hidden</span>
  </button>
</nav>

<div class="sidebar-section">
  <div class="sidebar-section-header" (click)="onShelfHeaderClick()">
    <span>Shelves</span>
    <span class="chevron" [class.expanded]="shelvesExpanded">â–¸</span>
  </div>
  @if (shelvesExpanded) {
    <div class="shelf-list">
      @if (documents$ | async; as docs) {
        <div
          class="shelf-item"
          title="Unshelved"
          [class.active]="(selectedShelfId$ | async) === null"
          (click)="emitSelect(null)"
          cdkDropList
          id="shelf-unshelved"
          [cdkDropListData]="docs"
          (cdkDropListDropped)="onDrop($event, null)"
        >
          @if (docs.length > 0 && docs[0].metadata?.coverUrl) {
            <img class="shelf-thumb" [src]="docs[0].metadata?.coverUrl" alt="" />
          } @else {
            <span class="shelf-thumb-placeholder">ğŸ“š</span>
          }
          <span class="shelf-name">Unshelved</span>
              <span class="nav-count">{{ unshelvedCount(docs) }}</span>
            </div>

            @if (shelves$ | async; as shelves) {
              @for (shelf of shelves; track shelf.id) {
                <div
                  class="shelf-item"
                  title="{{ shelf.name }}"
                  [class.active]="(selectedShelfId$ | async) === shelf.id"
                  (click)="emitSelect(shelf.id)"
                  cdkDropList
                  [id]="'shelf-' + shelf.id"
                  [cdkDropListData]="docs"
                  (cdkDropListDropped)="onDrop($event, shelf.id)"
                >
                  <span class="shelf-color-indicator" [style.background-color]="shelf.color"></span>
                  <span class="shelf-name">{{ shelf.name }}</span>
                  <span class="nav-count">{{ shelfCount(docs, shelf) }}</span>
                  <button
                    class="btn-delete-shelf"
                    (click)="emitDelete(shelf.id, $event)"
                    title="Delete shelf"
                  >Ã—</button>
                </div>
              }
            }
          }
          <button class="btn-create-shelf" (click)="createShelf.emit()">
            <span class="create-icon">âœï¸</span>
            <span>Create shelf</span>
          </button>
        </div>
      }
    </div>
